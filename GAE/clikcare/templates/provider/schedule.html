{% extends "/layout/provider.html" %}

{% set active_page = "schedule" %}

{% block subhead %}{{ _('Schedule') }}{% endblock %}
{% block lead %}{{ _('See your appointments and organize your time.') }}{% endblock %}

{% block content %}


<div class="row">
	<div class="span12">
		
		<!-- <a href="#" id="b14" class="btn btn-mini"> <i class="icon-ban-circle"></i> </a> -->
		<!--<button class="btn btn-mini" onclick="changeClass()" >My Button</button> -->
		
		<table class="table table-striped table-condensed">
			<thead>
				<th></th>
				<th></th>
				{% for day in days %}
				<th style="min-width: 55px">{{day[1]}}
				
				<!--
				<div class="btn-group" data-toggle="buttons-radio">
					<a href="#" class="btn btn-mini" rel="tooltip" title="{{ _('Busy All Day') }}"> <i class="icon-ban-circle"></i> </a>
					<a href="#" class="btn btn-mini" rel="tooltip" title="{{ _('Free All Day') }}"> <i class="icon-ok-circle"></i> </a>
				</div>
				-->
				</th>
				{% endfor %}
			</thead>
			{% for hour in hours %}
			
			{% if (hour[0] == "13" or hour[0] == "18") %}
				<tr> <td colspan="7"> <br> </td></tr>	
			{% endif %}
			
			<tr>
				<td rowspan="1">{{hour[0]|format_hour}}</td>
				<td></td>
				
				{% for day in days %}
				<td>
					{% set button_id = day[0] ~ '-' ~ hour[0] %}
					<div id="tt" class="btn-group" data-toggle="buttons-radio">
						{% if button_id in availableIds %}
							<a id="{{button_id}}" href="#" class="btn btn-mini btn-success" rel="tooltip" title="{{ _('Free') }}"> <i class="icon-ok-circle"></i> {{day[0]}}-{{hour[0]}} </a>
						{% else %}
							<a id="{{button_id}}" href="#" class="btn btn-mini btn-danger" rel="tooltip" title="{{ _('Busy') }}"> <i class="icon-ban-circle"></i> {{day[0]}}-{{hour[0]}} </a>
						{% endif %}
						<!-- <a href="#" class="btn btn-mini btn-warning" rel="tooltip" title="{{ _('Free') }}"> <i class="icon-ok-circle"></i> </a> -->
					</div>
				</td>
				{% endfor %}

			</tr>
			
			<!-- comment out :30 for now
			<tr>
				<td rowspan="1">  </td>
				<td></td>
				
				{% for day in days %}
				<td>
					<div class="btn-group" data-toggle="buttons-radio">
						<a href="#" class="btn btn-mini btn-success" rel="popover" title="{{ _('Appointment') }}" data-content="Jean Smith"><i class="icon-time"></i> </a>
						<a href="#" class="btn btn-mini" rel="tooltip" title="{{ _('Busy') }} {{hour[0]|format_30min_period(30)}}"> <i class="icon-ban-circle"></i> </a>
						<a href="#" class="btn btn-mini btn-warning" rel="tooltip" title="{{ _('Free') }}"> <i class="icon-ok-circle"></i> </a>
					</div>
				</td>
				{% endfor %}
				
			</tr>
			-->
			{% endfor %}
		</table>
	</div>
	
	<h3> Schedule Debug</h3>
	{% for s in p.schedule %}
		<li> {{s.day}}-{{s.time}} </li>
	{% endfor %}
</div>

<script src="/assets/js/jquery.js"></script>

<script>
    $("#tt a").click(function () {
    	//alert("I am an alert box! " + $("#b14").attr("Class")); 
     	$(this).toggleClass("btn-success");
     	$(this).toggleClass("btn-danger");
     	
     	if ($(this).hasClass('btn-success')) {
     		op = 'add'
     	}
     	else {
     		op = 'remove'
     	}
     		 
     	
     	post_data = {
     		provider_key: "{{p.key()}}",
     		day_time: $(this).attr("id"),
     		operation: op
     	}
     	// post a save for the clicked schedule
     	$.post('/provider/schedule', post_data)
    });
</script>


{% endblock %} 

				<!--
				<td>
				<div class="btn-group" data-toggle="buttons-radio">
					<a href="#" class="btn btn-mini" rel="tooltip" title="Non-Disponble"> <i class="icon-ban-circle"></i> </a>
					<a href="#" class="btn btn-mini btn-warning" rel="tooltip" title="Libre"> <i class="icon-ok-circle"></i> </a>
				</div></td>
				<td>
				<div class="btn-group" data-toggle="buttons-radio">
					<a href="#" class="btn btn-mini btn-danger" rel="tooltip" title="Non-Disponble"> <i class="icon-ban-circle"></i> </a>
					<a href="#" class="btn btn-mini" rel="tooltip" title="Libre"> <i class="icon-ok-circle"></i> </a>
				</div></td>
				<td>
				<div class="btn-group" data-toggle="buttons-radio">
					<a href="#" class="btn btn-mini" rel="tooltip" title="Non-Disponble"> <i class="icon-ban-circle"></i> </a>
					<a href="#" class="btn btn-mini btn-warning" rel="tooltip" title="Libre"> <i class="icon-ok-circle"></i> </a>
				</div></td>
				<td>
				<div class="btn-group" data-toggle="buttons-radio">
					<a href="#" class="btn btn-mini" rel="tooltip" title="Non-Disponble"> <i class="icon-ban-circle"></i> </a>
					<a href="#" class="btn btn-mini btn-warning" rel="tooltip" title="Libre"> <i class="icon-ok-circle"></i> </a>
				</div></td>
				<td>
				<div class="btn-group" data-toggle="buttons-radio">
					<a href="#" class="btn btn-mini" rel="tooltip" title="Non-Disponble"> <i class="icon-ban-circle"></i> </a>
					<a href="#" class="btn btn-mini btn-warning" rel="tooltip" title="Libre"> <i class="icon-ok-circle"></i> </a>
				</div></td>
				<td>
				<div class="btn-group" data-toggle="buttons-radio">
					<a href="#" class="btn btn-mini" rel="tooltip" title="Non-Disponble"> <i class="icon-ban-circle"></i> </a>
					<a href="#" class="btn btn-mini btn-warning" rel="tooltip" title="Libre"> <i class="icon-ok-circle"></i> </a>
				</div></td>
				-->