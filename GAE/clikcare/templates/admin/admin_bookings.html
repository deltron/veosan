{% extends "/layout/admin.html" %}

{% set active_page = "bookings" %}

{% block subhead %} <!-- Bookings -->
{% endblock %}
{% block lead %} <!-- View and administer bookings --> {% endblock %}

{% block content %}
<div class="row">
	<div class="span12">
		<table class="table">
			<thead>
				<tr>
					<!-- <th>Key</th> -->
					<th>Booking</th>
					<th>Patient</th>
					<th>Provider</th>
				</tr>
			</thead>
			<tbody>
				{% for b in bookings %}
				<tr>
					<!-- Date (Booking) -->
					<td><a href="/booking/detail"
					rel="popover"
					title="Booking Details"
					data-content="{{b.get_html_summary()}}"> {{b.dateTime|format_datetime_noseconds}} </a></td>
					<!-- Patient -->
					
					<td>
						{% if b.patient %}
							<a href="#" class="" rel="popover" title="{{b.patient.first_name}} {{b.patient.last_name}}" data-content="{{b.patient.phone}} <br> {{b.patient.email}} <br>">
							{{b.patient.first_name}} {{b.patient.last_name}}
							</a>
						{% else %}
							{% if b.requestEmail %}
								{{b.requestEmail}} <a href='#' rel="tooltip" title='User did not login'> <span class="badge badge-warning">!</span> </a>
								
							{% else %}
								<a href='#' rel="tooltip" title='User dropped out before entering email' style='color: grey;'> <em>No Email</em> </a>
							{% endif %}
						{% endif %}
					</td>
					<!-- Provider -->
					<td> {% set p = b.provider %}
					{% if p %} <a href="{{p.get_edit_link()}}"
					rel="popover"
					title="{{p.first_name}} {{p.last_name}}"
					data-content="{{p.get_html_summary()}}"> {{p.last_name}}, {{p.first_name}}</a> {% else %}
					<p>
						No provider booked
					</p> {% endif %} </td>
				</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
</div>
{% endblock content %} 